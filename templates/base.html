<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
<head>
    {% load static %}
    <!-- Add this early in the head, before other scripts -->
    <script src="{% static 'js/early-contrast.js' %}"></script>
    
    <!-- Accessibility: Skip to content link and ARIA landmarks -->
    <link rel="stylesheet" href="{% static 'css/accessibility.css' %}">
    <meta charset="UTF-8">
    <title>Elderly Care & Mindful Support Hub</title>
    
    <!-- Theme CSS -->
    <link rel="stylesheet" href="{% static 'css/theme.css' %}">
    <link rel="stylesheet" href="{% static 'css/dark-mode.css' %}">
    
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Other CSS -->
    <link rel="stylesheet" href="{% static 'css/main.css' %}">
    <link rel="stylesheet" href="{% static 'css/chat_modern.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/base.css' %}">

    
    {% include "partials/css_variables.html" %}
    {% block extra_css %}{% endblock %}
    
    <!-- Theme initialization script -->
    <script>
        // Initialize theme before page load to prevent flash
        (function() {
            const savedTheme = localStorage.getItem('theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            const theme = savedTheme || (prefersDark ? 'dark' : 'light');
            document.documentElement.setAttribute('data-bs-theme', theme);
        })();
    </script>
</head>
<body role="document">
    <!-- Skip to main content for screen readers/keyboard users -->
    <a href="#main-content" class="skip-link" id="skip-link">Skip to main content</a>
    <script src="{% static 'js/skip_link.js' %}"></script>
    <div class="d-flex justify-content-end p-2" aria-label="Accessibility options" role="region">
        <button id="increase-font" class="btn btn-outline-secondary btn-sm me-1" aria-label="Increase text size">A+</button>
        <button id="decrease-font" class="btn btn-outline-secondary btn-sm me-1" aria-label="Decrease text size">A-</button>
        <button id="toggle-contrast" class="btn btn-outline-warning btn-sm" aria-label="Toggle high contrast mode">High Contrast</button>
    </div>
    
    {% include "partials/navbar.html" %}
    
    <main id="main-content" class="container py-4" role="main">
        {% block content %}{% endblock %}
    </main>
    
    <!-- Bootstrap JS Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    
    <!-- Custom JavaScript -->
    <script src="{% static 'js/main.js' %}"></script>
    <script src="{% static 'js/accessibility.js' %}"></script>
    <script src="{% static 'js/theme_toggle.js' %}"></script>
    <script src="{% static 'js/clock.js' %}"></script>
    
    <script>
        window.CURRENT_USER_ID = "{{ user.id|default:'null' }}";
        if (window.CURRENT_USER_ID === "null" || window.CURRENT_USER_ID === "") {
            window.CURRENT_USER_ID = null;
        } else {
            window.CURRENT_USER_ID = parseInt(window.CURRENT_USER_ID, 10);
        }
    </script>
    
    <script src="{% static 'js/notification_system.js' %}"></script>
    <script src="{% static 'js/notification_ws.js' %}"></script>
    
    <!-- Notification Toast Container -->
    {% include "partials/toast.html" %}
    
    {% include "partials/user_vars.html" %}
    <script src="{% static 'js/notifications.js' %}"></script>
    <script src="{% static 'js/password_toggle.js' %}"></script>
    
    {% block extra_js %}{% endblock %}
    
    {% include "partials/footer.html" %}
</body>
</html>


